{% extends 'main.html' %}

{% block content %}

<h1>Home Page</h1>
    
        {% for p in products%}
        {% if not p.is_sold  %}
        
            <div class="card" style="width: 18rem; margin: 0%;">
                <a href="{% url 'view-product' p.id %}">
                    <div id="myCarousel" class="carousel slide" data-ride="carousel">

                        <!-- Wrapper for slides -->
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img class="d-block w-100" src="{{p.productimage_set.first.images.url}}"
                                    alt="First slide" style="height: 350px;">
                                <div class="carousel-caption d-none d-md-block">
                                </div>
                            </div>
                            {% for image in p.productimage_set.all %}
                            {% if p.productimage_set.first.images.url != image.images.url %}
                            <div class="carousel-item">
                                <img class="d-block w-100" src="{{image.images.url}}" alt="" style="height: 350px;">
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                </a>
                <h1><a style=" text-decoration:none" href="{% url 'view-product' p.id %}">{{p.product_name}}
                    </a>
                    {% if p.created_by.user.id == request.user.id or request.user.is_superuser%}
                    <a href="{% url 'delete-product' p.id %}"><img
                            src="https://raw.githubusercontent.com/mdrazak2001/Ecommerce_Application/nachiketa/FrontEnd/Images/dustbin.png"
                            alt="" style="width: 30px;" /></a>
                    {% endif %}
                </h1>

                <p class="price">&#8377;{{p.price_in_rupees}}/-</p>
                {% if request.user.id != p.created_by.user.id and not request.user.is_superuser %}
                <a href="{% url 'add-to-cart' p.id %}">
                    <p><button>Add to Carts</button></p>
                </a>
                {% endif %}

            </div>
        
        {% endif %}
        {% endfor %}
    

<script>
    // Handle Bootstrap carousel slide event
    $('.carousel').carousel({
        interval: 2500
    });
</script>

{% endblock %}